title: 'Event ID 4696: A primary token was assigned to process'
operating_system: windows
data_channel: security
description: This event generates every time a process runs using the non-current
  access token, for example, UAC elevated token, RUN AS different user actions, scheduled
  task with defined user, services, and so on.
data_fields:
- standard_name: user_sid
  field_name: SubjectUserSid
  type: string
  description: SID of account that requested the "assign token to process" operation.
  sample_value: S-1-5-18
- standard_name: user_name
  field_name: SubjectUserName
  type: string
  description: the name of the account that requested the "assign token to process"
    operation.
  sample_value: WIN2008$
- standard_name: user_domain
  field_name: SubjectDomainName
  type: string
  description: subject's domain or computer name.
  sample_value: CONTOSO
- standard_name: user_logon_id
  field_name: SubjectLogonId
  type: integer
  description: 'hexadecimal value that can help you correlate this event with recent
    events that might contain the same Logon ID, for example, "4624: An account was
    successfully logged on."'
  sample_value: '0x3e7'
- standard_name: target_user_sid
  field_name: TargetUserSid
  type: string
  description: SID of account through which the security token will be assigned to
    the new process. Event Viewer automatically tries to resolve SIDs and show the
    account name. If the SID cannot be resolved, you will see the source data in the
    event.
  sample_value: S-1-5-18
- standard_name: target_user_name
  field_name: TargetUserName
  type: string
  description: the name of the account through which the security token will be assigned
    to the new process.
  sample_value: dadmin
- standard_name: target_user_domain
  field_name: TargetDomainName
  type: string
  description: subject's domain or computer name.
  sample_value: CONTOSO
- standard_name: target_user_logon_id
  field_name: TargetLogonId
  type: integer
  description: 'hexadecimal value that can help you correlate this event with recent
    events that might contain the same Logon ID, for example, "4624: An account was
    successfully logged on."'
  sample_value: '0x1c8c5'
- standard_name: target_process_id
  field_name: TargetProcessId
  type: integer
  description: hexadecimal Process ID of the new process with new security token.
    If you convert the hexadecimal value to decimal, you can compare it to the values
    in Task Manager.
  sample_value: '0xf40'
- standard_name: target_process_name
  field_name: TargetProcessName
  type: string
  description: full path and the name of the executable for the new process.
  sample_value: C:\Windows\System32\WerFault.exe
- standard_name: process_id
  field_name: ProcessId
  type: integer
  description: hexadecimal Process ID of the process which started the new process
    with the new security token.
  sample_value: '0x698'
- standard_name: process_name
  field_name: ProcessName
  type: string
  description: full path and the name of the executable for the process which ran
    the new process with new security token.
  sample_value: C:\Windows\System32\svchost.exe
resources:
- text: MS Source
  link: https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4696.md
- text: MS Security Auditing Category - Detailed Tracking
  link: https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/advanced-security-audit-policy-settings#detailed-tracking
- text: MS Security Auditing Sub-category - Audit Process Creation
  link: https://github.com/MicrosoftDocs/windows-itpro-docs/tree/master/windows/security/threat-protection/auditing/audit-process-creation.md
tags:
- Detailed Tracking
- Audit Process Creation
