title: 'Event ID 5157: The Windows Filtering Platform has permitted a connection'
operating_system: windows
data_channel: security
description: This event generates when Windows Filtering Platform has blocked a connection.
data_fields:
- standard_name: process_id
  field_name: ProcessId
  type: integer
  description: Hexadecimal Process ID of the process that attempted to create the
    connection.
  sample_value: '4556'
- standard_name: process_path
  field_name: Application
  type: string
  description: Full path and the name of the executable for the process.
  sample_value: \device\harddiskvolume2\documents\listener.exe
- standard_name: ''
  field_name: Direction
  type: string
  description: Direction of blocked connection.
  sample_value: Inbound
- standard_name: src_ip_addr
  field_name: SourceAddress
  type: ip
  description: Local IP address on which application received the connection.
  sample_value: 10.0.0.10
- standard_name: src_port
  field_name: SourcePort
  type: integer
  description: Port number on which application received the connection.
  sample_value: '3333'
- standard_name: dst_ip_addr
  field_name: DestAddress
  type: ip
  description: IP address from which connection was received or initiated.
  sample_value: 10.0.0.100
- standard_name: dst_port
  field_name: DestPort
  type: integer
  description: Port number which was used from remote machine to initiate connection.
  sample_value: '49218'
- standard_name: network_protocol
  field_name: Protocol
  type: integer
  description: Protocol number.
  sample_value: '6'
- standard_name: ''
  field_name: FilterRTID
  type: integer
  description: Unique filter ID which blocked the connection.
  sample_value: '110398'
- standard_name: ''
  field_name: LayerName
  type: string
  description: Application Layer Enforcement layer name.
  sample_value: '%%14610'
- standard_name: ''
  field_name: LayerRTID
  type: integer
  description: Windows Filtering Platform layer identifier.
  sample_value: '44'
- standard_name: ''
  field_name: RemoteUserID
  type: ''
  description: ''
  sample_value: S-1-0-0
- standard_name: ''
  field_name: RemoteMachineID
  type: ''
  description: ''
  sample_value: S-1-0-0
resources:
- text: MS Source
  link: https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-5157.md
- text: MS Security Auditing Category - Object Access
  link: https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/advanced-security-audit-policy-settings#object-access
- text: MS Security Auditing Sub-category - Audit Filtering Platform Connection
  link: https://github.com/MicrosoftDocs/windows-itpro-docs/tree/master/windows/security/threat-protection/auditing/audit-filtering-platform-connection.md
tags:
- Object Access
- Audit Filtering Platform Connection
