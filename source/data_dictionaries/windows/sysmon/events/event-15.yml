title: 'Event ID 15: FileCreateStreamHash'
operating_system: windows
data_channel: sysmon
description: This event logs when a named file stream is created, and it generates
  events that log the hash of the contents of the file to which the stream is assigned
  (the unnamed stream), as well as the contents of the named stream. There are malware
  variants that drop their executables or configuration settings via browser downloads,
  and this event is aimed at capturing that based on the browser attaching a Zone.Identifier
  "mark of the web" stream.<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-15-filecreatestreamhash">https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-15-filecreatestreamhash</a>
data_fields:
- standard_name: tag
  field_name: RuleName
  type: string
  description: custom tag mapped to event. i.e ATT&CK technique ID
  sample_value: T1114
- standard_name: event_date_creation
  field_name: UtcTime
  type: date
  description: Time in UTC when event was created
  sample_value: 4/11/18 5:25
- standard_name: process_guid
  field_name: ProcessGuid
  type: string
  description: Process Guid of the process that created the named file stream
  sample_value: '{A98268C1-A8A0-5ACD-0000-001087DEBF00}'
- standard_name: process_id
  field_name: ProcessId
  type: integer
  description: Process ID used by the os to identify the process that created the
    named file stream
  sample_value: '6972'
- standard_name: process_name
  field_name: Image
  type: string
  description: File name of the process that created the named file stream
  sample_value: chrome.exe
- standard_name: process_path
  field_name: Image
  type: string
  description: File path of the process that created the named file stream
  sample_value: C:\Program Files (x86)\Google\Chrome\Application\chrome.exe
- standard_name: file_name
  field_name: TargetFilename
  type: string
  description: Name of the file
  sample_value: C:\Users\wardog\Downloads\a0fa35bc5badf505f803921f0fe40971-4cf6bad280c7b66e21bb8e96ffe2f968ca460e0d.zip:Zone.Identifier
- standard_name: file_creation_time
  field_name: CreationUtcTime
  type: date
  description: File download time
  sample_value: 4/11/18 6:18
- standard_name: hash
  field_name: Hash
  type: string
  description: hash is a full hash of the file with the algorithms in the HashType
    field
  sample_value: SHA1=F897DA14CF93C872CE821F549C34B848E345C8AC, MD5=697C69E7BB023075F14BC0BE25B875D8,
    SHA256=3157F3E7A854A13A40FFC79472C319E5B7C744B50D869D6E45F40CD4218539C5, IMPHASH=00000000000000000000000000000000
resources:
- text: Sysmon Source
  link: https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-15-filecreatestreamhash
tags: []
